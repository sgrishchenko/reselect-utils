(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getObjectPaths=exports.arePathsEqual=exports.isObject=exports.setDebugMode=exports.isDebugMode=exports.defaultKeySelector=exports.defineDynamicSelectorName=exports.isCachedSelector=exports.getSelectorName=void 0;exports.getSelectorName=selector=>"selectorName"in selector&&selector.selectorName?selector.selectorName:selector.name;exports.isCachedSelector=selector=>selector instanceof Object&&"keySelector"in selector;exports.defineDynamicSelectorName=(selector,selectorNameGetter)=>{let overriddenSelectorName;Object.defineProperty(selector,"selectorName",{configurable:!0,get:()=>null!=overriddenSelectorName?overriddenSelectorName:selectorNameGetter(),set:value=>{overriddenSelectorName=value}})};exports.defaultKeySelector=()=>"<DefaultKey>";let debugMode=!0;exports.isDebugMode=()=>debugMode;exports.setDebugMode=value=>{debugMode=value};exports.isObject=value=>null!==value&&"object"==typeof value;exports.arePathsEqual=(path,anotherPath)=>{if(path.length!==anotherPath.length)return!1;for(let i=0;i<path.length;i+=1)if(path[i]!==anotherPath[i])return!1;return!0};exports.getObjectPaths=(value,parentPath=[])=>exports.isObject(value)?Object.keys(value).reduce((result,key)=>{const paths=exports.getObjectPaths(value[key],parentPath.concat([key]));return result.concat(paths)},[]):[parentPath]},147:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelectorGraph=void 0;const react_1=__importStar(__webpack_require__(44)),reselect_tools_1=__webpack_require__(714),cytoscapeUtils_1=__webpack_require__(715);exports.SelectorGraph=({selectors:selectors,onNodeClick:onNodeClick,style:style})=>{const[nodes,setNodes]=react_1.useState({}),[edges,setEdges]=react_1.useState([]),cy=react_1.useRef(),cyElement=react_1.useRef(null);return react_1.useEffect(()=>{reselect_tools_1.reset(),reselect_tools_1.registerSelectors(selectors);const graph=reselect_tools_1.selectorGraph();setNodes(graph.nodes),setEdges(graph.edges)},[selectors,setNodes,setEdges]),react_1.useEffect(()=>{cy.current||(cy.current=cytoscapeUtils_1.drawCytoscapeGraph(cyElement.current)),cytoscapeUtils_1.updateCytoscapeGraph(cy.current,nodes,edges)},[cy,cyElement,nodes,edges]),react_1.useEffect(()=>{cy.current&&(cy.current.off("click","node"),cy.current.on("click","node",event=>{const target=event.target,{name:name}=target.data();onNodeClick(name,reselect_tools_1.checkSelector(name))}))},[cy,onNodeClick]),react_1.useEffect(()=>()=>{cy.current&&cy.current.destroy()},[cy]),react_1.default.createElement("div",{style:Object.assign({height:"100%"},style),ref:cyElement,title:"Double Click to Reset",onDoubleClick:()=>cy.current&&cytoscapeUtils_1.updateCytoscapeGraph(cy.current,nodes,edges)})}},223:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createKeySelectorComposer=exports.isComposedKeySelector=exports.composedKeySelectorSymbol=void 0,exports.composedKeySelectorSymbol=Symbol.for("ComposedKeySelector"),exports.isComposedKeySelector=function isComposedKeySelector(keySelector){return"dependencies"in keySelector&&exports.composedKeySelectorSymbol in keySelector},exports.createKeySelectorComposer=function createKeySelectorComposer(baseKeySelectorComposer){return(...keySelectors)=>{const resultSelector=baseKeySelectorComposer(...keySelectors);return resultSelector.dependencies=keySelectors,Object.defineProperty(resultSelector,exports.composedKeySelectorSymbol,{value:!0}),resultSelector}}},365:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStructuredSelector=void 0;const reselect_1=__webpack_require__(87);exports.createStructuredSelector=function createStructuredSelector(selectors,selectorCreator=reselect_1.createSelector){const objectKeys=Object.keys(selectors);return selectorCreator(objectKeys.map(key=>selectors[key]),(...values)=>values.reduce((composition,value,index)=>Object.assign(Object.assign({},composition),{[objectKeys[index]]:value}),{}))}},366:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createBoundSelector=void 0;const helpers_1=__webpack_require__(111),createKeySelectorComposer_1=__webpack_require__(223),createPropSelector_1=__webpack_require__(367),createKeySelectorCreator_1=__webpack_require__(369),stringComposeKeySelectors_1=__webpack_require__(370),innerCreateBoundSelector=(baseSelector,binding)=>(state,props)=>baseSelector(state,Object.assign(Object.assign({},props),binding));exports.createBoundSelector=(baseSelector,binding,options={})=>{var _a,_b;const bindingStrategy=null!==(_a=options.bindingStrategy)&&void 0!==_a?_a:innerCreateBoundSelector,keySelectorComposer=null!==(_b=options.keySelectorComposer)&&void 0!==_b?_b:stringComposeKeySelectors_1.stringComposeKeySelectors,boundSelector=bindingStrategy(baseSelector,binding);if(Object.assign(boundSelector,baseSelector),boundSelector.dependencies=[baseSelector],helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(boundSelector,()=>`${helpers_1.getSelectorName(baseSelector)} (${(binding=>{const structure=Object.keys(binding).reduce((result,key)=>Object.assign(Object.assign({},result),{[key]:"[*]"}),{});return`${Object.keys(structure).join()} -> ${Object.values(structure).join()}`})(binding)})`),helpers_1.isCachedSelector(baseSelector)){const cachedBoundSelector=boundSelector;baseSelector.getMatchingSelector&&(cachedBoundSelector.getMatchingSelector=bindingStrategy(baseSelector.getMatchingSelector,binding)),baseSelector.removeMatchingSelector&&(cachedBoundSelector.removeMatchingSelector=bindingStrategy(baseSelector.removeMatchingSelector,binding));const baseKeySelector=baseSelector.keySelector;if(helpers_1.isObject(binding)){const paths=helpers_1.getObjectPaths(binding);let keySelectors=createKeySelectorComposer_1.isComposedKeySelector(baseKeySelector)?baseKeySelector.dependencies:[baseKeySelector];if(keySelectors=createKeySelectorCreator_1.excludeDefaultSelectors(keySelectors),keySelectors=keySelectors.filter(keySelector=>!createPropSelector_1.isPropSelector(keySelector)||!paths.some(path=>helpers_1.arePathsEqual(keySelector.path,path))).map(keySelector=>createPropSelector_1.isPropSelector(keySelector)?keySelector:bindingStrategy(keySelector,binding)),0===keySelectors.length)cachedBoundSelector.keySelector=helpers_1.defaultKeySelector;else if(1===keySelectors.length){const[keySelector]=keySelectors;cachedBoundSelector.keySelector=keySelector}else cachedBoundSelector.keySelector=keySelectorComposer(...keySelectors)}else cachedBoundSelector.keySelector=bindingStrategy(baseKeySelector,binding)}return boundSelector}},367:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPropSelector=exports.isPropSelector=void 0;const createPathSelector_1=__webpack_require__(368),propSelectorSymbol=Symbol.for("PropSelector");exports.isPropSelector=selector=>selector instanceof Object&&propSelectorSymbol in selector,exports.createPropSelector=function createPropSelector(){return createPathSelector_1.innerCreatePathSelector((state,props)=>props,[],selector=>{Object.defineProperty(selector,propSelectorSymbol,{value:!0})})}},368:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPathSelector=exports.innerCreatePathSelector=void 0;const helpers_1=__webpack_require__(111);exports.innerCreatePathSelector=(baseSelector,path=[],applyMeta=(()=>{}))=>new Proxy(defaultValue=>{function resultSelector(){let result=baseSelector.apply(null,arguments);for(let i=0;i<path.length&&helpers_1.isObject(result);i+=1)result=result[path[i]];return null!=result?result:defaultValue}return Object.assign(resultSelector,baseSelector,{path:path}),resultSelector.dependencies=[baseSelector],applyMeta(resultSelector),helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(resultSelector,()=>[helpers_1.getSelectorName(baseSelector),...path].join(".")),resultSelector},{get:(target,key)=>exports.innerCreatePathSelector(baseSelector,[...path,String(key)],applyMeta)}),exports.createPathSelector=function createPathSelector(baseSelector){return exports.innerCreatePathSelector(baseSelector)}},369:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createKeySelectorCreator=exports.excludeDefaultSelectors=void 0;const createPropSelector_1=__webpack_require__(367),helpers_1=__webpack_require__(111),createKeySelectorComposer_1=__webpack_require__(223),flatKeySelectors=keySelectors=>{const result=[];for(let i=0;i<keySelectors.length;i+=1){const keySelector=keySelectors[i];createKeySelectorComposer_1.isComposedKeySelector(keySelector)?result.push(...flatKeySelectors(keySelector.dependencies)):result.push(keySelector)}return result};exports.excludeDefaultSelectors=keySelectors=>{const result=[];for(let i=0;i<keySelectors.length;i+=1){const keySelector=keySelectors[i];keySelector!==helpers_1.defaultKeySelector&&result.push(keySelector)}return result},exports.createKeySelectorCreator=function createKeySelectorCreator(keySelectorComposer){return({inputSelectors:inputSelectors,keySelector:keySelector})=>{let keySelectors=[];if(keySelector&&keySelectors.push(keySelector),inputSelectors.forEach(selector=>{helpers_1.isCachedSelector(selector)&&keySelectors.push(selector.keySelector)}),keySelectors=flatKeySelectors(keySelectors),keySelectors=(keySelectors=>{const result=[];for(let i=0;i<keySelectors.length;i+=1){const keySelector=keySelectors[i];result.some(resultKeySelector=>{return(selector=keySelector)===(another=resultKeySelector)||!(!createPropSelector_1.isPropSelector(selector)||!createPropSelector_1.isPropSelector(another))&&helpers_1.arePathsEqual(selector.path,another.path);var selector,another})||result.push(keySelector)}return result})(keySelectors),keySelectors=exports.excludeDefaultSelectors(keySelectors),0===keySelectors.length)return helpers_1.defaultKeySelector;if(1===keySelectors.length){const[resultSelector]=keySelectors;return resultSelector}return keySelectorComposer(...keySelectors)}}},370:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stringComposeKeySelectors=void 0;const createKeySelectorComposer_1=__webpack_require__(223);exports.stringComposeKeySelectors=createKeySelectorComposer_1.createKeySelectorComposer((...keySelectors)=>(state,props)=>{let key=keySelectors[0](state,props);for(let i=1;i<keySelectors.length;i+=1)key+=":",key+=keySelectors[i](state,props);return key})},371:function(module,exports,__webpack_require__){__webpack_require__(372),__webpack_require__(544),module.exports=__webpack_require__(545)},446:function(module,exports){},545:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(88);module._StorybookPreserveDecorators=!0,Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(698)],module)}.call(this,__webpack_require__(546)(module))},698:function(module,exports,__webpack_require__){var map={"./reselect-utils/src/__stories__/createAdaptedSelector.story.tsx":699,"./reselect-utils/src/__stories__/createBoundSelector.story.tsx":834,"./reselect-utils/src/__stories__/createChainSelector.story.tsx":835,"./reselect-utils/src/__stories__/createPathSelector.story.tsx":841};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=698},699:function(module,exports,__webpack_require__){"use strict";(function(module){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(66).withSource,__STORY__=(__webpack_require__(66).addSource,"import React, { useMemo } from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { action } from '@storybook/addon-actions';\nimport { SelectorGraph } from './SelectorGraph';\nimport { State } from '../__data__/state';\nimport { createAdaptedSelector } from '../createAdaptedSelector';\nimport { createStructuredSelector } from '../createStructuredSelector';\n\nstoriesOf('createAdaptedSelector', module).add('example', () => {\n  const selectors = useMemo(() => {\n    /* SELECTORS DEFINITION START */\n    const personSelector = (state: State, props: { id: number }) =>\n      state.persons[props.id];\n    const messageSelector = (state: State, props: { id: number }) =>\n      state.messages[props.id];\n\n    const personAndMessageSelector = createStructuredSelector({\n      person: createAdaptedSelector(\n        personSelector,\n        (props: { personId: number }) => ({\n          id: props.personId,\n        }),\n      ),\n      message: createAdaptedSelector(\n        messageSelector,\n        (props: { messageId: number }) => ({\n          id: props.messageId,\n        }),\n      ),\n    });\n    /* SELECTORS DEFINITION END */\n\n    return {\n      personSelector,\n      messageSelector,\n      personAndMessageSelector,\n    };\n  }, []);\n\n  return (\n    <SelectorGraph\n      selectors={selectors}\n      onNodeClick={(name, node) => action(name)(node)}\n    />\n  );\n});\n"),__ADDS_MAP__={"createadaptedselector--example":{startLoc:{col:47,line:9},endLoc:{col:1,line:46},startBody:{col:58,line:9},endBody:{col:1,line:46}}};const react_1=__importStar(__webpack_require__(44)),react_2=__webpack_require__(88),addon_actions_1=__webpack_require__(110),SelectorGraph_1=__webpack_require__(147),createAdaptedSelector_1=__webpack_require__(833),createStructuredSelector_1=__webpack_require__(365);react_2.storiesOf("createAdaptedSelector",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/createAdaptedSelector.story.tsx",[],{},"/home/travis/build/sgrishchenko/reselect-utils/packages/reselect-utils/src/__stories__",{})).add("example",()=>{const selectors=react_1.useMemo(()=>{const personSelector=(state,props)=>state.persons[props.id],messageSelector=(state,props)=>state.messages[props.id];return{personSelector:personSelector,messageSelector:messageSelector,personAndMessageSelector:createStructuredSelector_1.createStructuredSelector({person:createAdaptedSelector_1.createAdaptedSelector(personSelector,props=>({id:props.personId})),message:createAdaptedSelector_1.createAdaptedSelector(messageSelector,props=>({id:props.messageId}))})}},[]);return react_1.default.createElement(SelectorGraph_1.SelectorGraph,{selectors:selectors,onNodeClick:(name,node)=>addon_actions_1.action(name)(node)})})}).call(this,__webpack_require__(49)(module))},715:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateCytoscapeGraph=exports.drawCytoscapeGraph=exports.createCytoElements=void 0;const cytoscape_1=__importDefault(__webpack_require__(716));cytoscape_1.default.use(__webpack_require__(720));const dagreLayout={name:"dagre",rankDir:"BT",ranker:"longest-path",nodeDimensionsIncludeLabels:!0},theme=new URL(document.location.href).searchParams.get("theme"),cytoDefaults={style:[{selector:"node",style:{"background-color":"#666",color:"dark"===theme?"#fff":"#000",label:"data(id)"}},{selector:"edge",style:{width:3,"line-color":"dark"===theme?"#444":"#ccc","target-arrow-color":"dark"===theme?"#444":"#ccc","target-arrow-shape":"triangle"}}],layout:dagreLayout};exports.createCytoElements=(nodes,edges)=>[...Object.entries(nodes).map(([name,node])=>({data:Object.assign({id:name},node)})),...edges.map((edge,index)=>({data:{id:""+index,source:edge.from,target:edge.to}}))];exports.drawCytoscapeGraph=cyElement=>cytoscape_1.default(Object.assign(Object.assign({},cytoDefaults),{container:cyElement}));exports.updateCytoscapeGraph=(cy,nodes,edges)=>{const elements=exports.createCytoElements(nodes,edges);cy.json({elements:elements}),cy.layout(dagreLayout).run()}},833:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createAdaptedSelector=void 0;const helpers_1=__webpack_require__(111),innerCreateAdaptedSelector=(baseSelector,mapping)=>(state,props)=>baseSelector(state,mapping(props));exports.createAdaptedSelector=(baseSelector,mapping)=>{const adaptedSelector=innerCreateAdaptedSelector(baseSelector,mapping);if(Object.assign(adaptedSelector,baseSelector),adaptedSelector.dependencies=[baseSelector],helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(adaptedSelector,()=>`${helpers_1.getSelectorName(baseSelector)} (${(mapping=>{if(mapping.name)return mapping.name;const structure=mapping(new Proxy({},{get:(target,key)=>key}));return`${Object.keys(structure).join()} -> ${Object.values(structure).join()}`})(mapping)})`),helpers_1.isCachedSelector(baseSelector)){const cachedAdaptedSelector=adaptedSelector;baseSelector.getMatchingSelector&&(cachedAdaptedSelector.getMatchingSelector=innerCreateAdaptedSelector(baseSelector.getMatchingSelector,mapping)),baseSelector.removeMatchingSelector&&(cachedAdaptedSelector.removeMatchingSelector=innerCreateAdaptedSelector(baseSelector.removeMatchingSelector,mapping)),cachedAdaptedSelector.keySelector=innerCreateAdaptedSelector(baseSelector.keySelector,mapping)}return adaptedSelector}},834:function(module,exports,__webpack_require__){"use strict";(function(module){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(66).withSource,__STORY__=(__webpack_require__(66).addSource,"import React, { useMemo } from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { action } from '@storybook/addon-actions';\nimport { SelectorGraph } from './SelectorGraph';\nimport { State } from '../__data__/state';\nimport { createBoundSelector } from '../createBoundSelector';\nimport { createStructuredSelector } from '../createStructuredSelector';\n\nstoriesOf('createBoundSelector', module).add('example', () => {\n  const selectors = useMemo(() => {\n    /* SELECTORS DEFINITION START */\n    const personSelector = (state: State, props: { id: number }) =>\n      state.persons[props.id];\n    const messageSelector = (state: State, props: { id: number }) =>\n      state.messages[props.id];\n\n    const marryAndHelloSelector = createStructuredSelector({\n      person: createBoundSelector(personSelector, { id: 1 }),\n      message: createBoundSelector(messageSelector, { id: 100 }),\n    });\n    /* SELECTORS DEFINITION END */\n\n    return {\n      personSelector,\n      messageSelector,\n      marryAndHelloSelector,\n    };\n  }, []);\n\n  return (\n    <SelectorGraph\n      selectors={selectors}\n      onNodeClick={(name, node) => action(name)(node)}\n    />\n  );\n});\n"),__ADDS_MAP__={"createboundselector--example":{startLoc:{col:45,line:9},endLoc:{col:1,line:36},startBody:{col:56,line:9},endBody:{col:1,line:36}}};const react_1=__importStar(__webpack_require__(44)),react_2=__webpack_require__(88),addon_actions_1=__webpack_require__(110),SelectorGraph_1=__webpack_require__(147),createBoundSelector_1=__webpack_require__(366),createStructuredSelector_1=__webpack_require__(365);react_2.storiesOf("createBoundSelector",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/createBoundSelector.story.tsx",[],{},"/home/travis/build/sgrishchenko/reselect-utils/packages/reselect-utils/src/__stories__",{})).add("example",()=>{const selectors=react_1.useMemo(()=>{const personSelector=(state,props)=>state.persons[props.id],messageSelector=(state,props)=>state.messages[props.id];return{personSelector:personSelector,messageSelector:messageSelector,marryAndHelloSelector:createStructuredSelector_1.createStructuredSelector({person:createBoundSelector_1.createBoundSelector(personSelector,{id:1}),message:createBoundSelector_1.createBoundSelector(messageSelector,{id:100})})}},[]);return react_1.default.createElement(SelectorGraph_1.SelectorGraph,{selectors:selectors,onNodeClick:(name,node)=>addon_actions_1.action(name)(node)})})}).call(this,__webpack_require__(49)(module))},835:function(module,exports,__webpack_require__){"use strict";(function(module){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(66).withSource,__STORY__=(__webpack_require__(66).addSource,"import React, { useMemo, useState } from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { action } from '@storybook/addon-actions';\nimport { createSelector, Selector } from 'reselect';\nimport { Message, Person, commonState, State } from '../__data__/state';\nimport { createBoundSelector } from '../createBoundSelector';\nimport { createSequenceSelector } from '../createSequenceSelector';\nimport { createChainSelector } from '../createChainSelector';\nimport { ChainSelectorGraph } from './ChainSelectorGraph';\n\nstoriesOf('createChainSelector', module)\n  .add('entity chain example', () => {\n    const [called, setCalled] = useState(false);\n\n    const selectors = useMemo(() => {\n      /* SELECTORS DEFINITION START */\n      const personSelector = (state: State, props: { id: number }) =>\n        state.persons[props.id];\n      const messageSelector = (state: State, props: { id: number }) =>\n        state.messages[props.id];\n      const documentSelector = (state: State, props: { id: number }) =>\n        state.documents[props.id];\n\n      const fullNameSelector = createSelector(\n        [personSelector],\n        ({ firstName = '', secondName = '' }) => `${firstName} ${secondName}`,\n      );\n\n      const personByDocumentIdSelector = createChainSelector(documentSelector)\n        .chain((document) =>\n          createBoundSelector(messageSelector, { id: document.messageId }),\n        )\n        .chain((message) =>\n          createBoundSelector(fullNameSelector, { id: message.personId }),\n        )\n        .build();\n      /* SELECTORS DEFINITION END */\n\n      if (called) {\n        const personByDocumentId = personByDocumentIdSelector(commonState, {\n          id: 111,\n        });\n\n        action('personByDocumentId')(personByDocumentId);\n      }\n\n      return {\n        personSelector,\n        messageSelector,\n        documentSelector,\n        fullNameSelector,\n        personByDocumentIdSelector,\n      };\n    }, [called]);\n\n    return (\n      <ChainSelectorGraph\n        selectors={selectors}\n        onCallButtonClick={() => setCalled(true)}\n      />\n    );\n  })\n  .add('aggregation example', () => {\n    const [called, setCalled] = useState(false);\n\n    const selectors = useMemo(() => {\n      /* SELECTORS DEFINITION START */\n      const personsSelector = (state: State) => state.persons;\n\n      const personSelector = (state: State, props: { id: number }) =>\n        state.persons[props.id];\n\n      const fullNameSelector = createSelector(\n        [personSelector],\n        ({ firstName = '', secondName = '' }) => `${firstName} ${secondName}`,\n      );\n\n      const longestFullNameSelector = createChainSelector(personsSelector)\n        .chain((persons) =>\n          createSequenceSelector(\n            Object.values(persons).map((person) =>\n              createBoundSelector(fullNameSelector, { id: person.id }),\n            ),\n          ),\n        )\n        .map((fullNames) =>\n          fullNames.reduce((longest, current) =>\n            current.length > longest.length ? current : longest,\n          ),\n        )\n        .build();\n      /* SELECTORS DEFINITION END */\n\n      if (called) {\n        const longestFullName = longestFullNameSelector(commonState);\n\n        action('longestFullName')(longestFullName);\n      }\n\n      return {\n        personSelector,\n        personsSelector,\n        fullNameSelector,\n        longestFullNameSelector,\n      };\n    }, [called]);\n\n    return (\n      <ChainSelectorGraph\n        selectors={selectors}\n        onCallButtonClick={() => setCalled(true)}\n      />\n    );\n  })\n  .add('switch dependency example', () => {\n    const [documentId, setDocumentId] = useState<number>();\n\n    const selectors = useMemo(() => {\n      /* SELECTORS DEFINITION START */\n      const personSelector = (state: State, props: { id: number }) =>\n        state.persons[props.id];\n      const messageSelector = (state: State, props: { id: number }) =>\n        state.messages[props.id];\n      const documentSelector = (state: State, props: { id: number }) =>\n        state.documents[props.id];\n\n      const personOrMessageByDocumentIdSelector = createChainSelector(\n        documentSelector,\n      )\n        .chain(\n          (document) =>\n            (document.messageId === 100\n              ? createBoundSelector(personSelector, { id: 1 })\n              : createBoundSelector(messageSelector, {\n                  id: document.messageId,\n                })) as Selector<State, Person | Message>,\n        )\n        .build();\n      /* SELECTORS DEFINITION END */\n\n      if (documentId !== undefined) {\n        const personOrMessageByDocumentId = personOrMessageByDocumentIdSelector(\n          commonState,\n          {\n            id: documentId,\n          },\n        );\n\n        action('personOrMessageByDocumentId')(personOrMessageByDocumentId);\n      }\n\n      return {\n        personSelector,\n        messageSelector,\n        documentSelector,\n        personOrMessageByDocumentIdSelector,\n      };\n    }, [documentId]);\n\n    return (\n      <ChainSelectorGraph\n        selectors={selectors}\n        onCallButtonClick={() => setDocumentId(documentId === 111 ? 222 : 111)}\n      />\n    );\n  });\n"),__ADDS_MAP__={"createchainselector--switch-dependency-example":{startLoc:{col:7,line:115},endLoc:{col:3,line:166},startBody:{col:36,line:115},endBody:{col:3,line:166}},"createchainselector--aggregation-example":{startLoc:{col:7,line:63},endLoc:{col:3,line:114},startBody:{col:30,line:63},endBody:{col:3,line:114}},"createchainselector--entity-chain-example":{startLoc:{col:7,line:12},endLoc:{col:3,line:62},startBody:{col:31,line:12},endBody:{col:3,line:62}}};const react_1=__importStar(__webpack_require__(44)),react_2=__webpack_require__(88),addon_actions_1=__webpack_require__(110),reselect_1=__webpack_require__(87),state_1=__webpack_require__(836),createBoundSelector_1=__webpack_require__(366),createSequenceSelector_1=__webpack_require__(837),createChainSelector_1=__webpack_require__(838),ChainSelectorGraph_1=__webpack_require__(840);react_2.storiesOf("createChainSelector",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/createChainSelector.story.tsx",[],{},"/home/travis/build/sgrishchenko/reselect-utils/packages/reselect-utils/src/__stories__",{})).add("entity chain example",()=>{const[called,setCalled]=react_1.useState(!1),selectors=react_1.useMemo(()=>{const personSelector=(state,props)=>state.persons[props.id],messageSelector=(state,props)=>state.messages[props.id],documentSelector=(state,props)=>state.documents[props.id],fullNameSelector=reselect_1.createSelector([personSelector],({firstName:firstName="",secondName:secondName=""})=>`${firstName} ${secondName}`),personByDocumentIdSelector=createChainSelector_1.createChainSelector(documentSelector).chain(document=>createBoundSelector_1.createBoundSelector(messageSelector,{id:document.messageId})).chain(message=>createBoundSelector_1.createBoundSelector(fullNameSelector,{id:message.personId})).build();if(called){const personByDocumentId=personByDocumentIdSelector(state_1.commonState,{id:111});addon_actions_1.action("personByDocumentId")(personByDocumentId)}return{personSelector:personSelector,messageSelector:messageSelector,documentSelector:documentSelector,fullNameSelector:fullNameSelector,personByDocumentIdSelector:personByDocumentIdSelector}},[called]);return react_1.default.createElement(ChainSelectorGraph_1.ChainSelectorGraph,{selectors:selectors,onCallButtonClick:()=>setCalled(!0)})}).add("aggregation example",()=>{const[called,setCalled]=react_1.useState(!1),selectors=react_1.useMemo(()=>{const personsSelector=state=>state.persons,personSelector=(state,props)=>state.persons[props.id],fullNameSelector=reselect_1.createSelector([personSelector],({firstName:firstName="",secondName:secondName=""})=>`${firstName} ${secondName}`),longestFullNameSelector=createChainSelector_1.createChainSelector(personsSelector).chain(persons=>createSequenceSelector_1.createSequenceSelector(Object.values(persons).map(person=>createBoundSelector_1.createBoundSelector(fullNameSelector,{id:person.id})))).map(fullNames=>fullNames.reduce((longest,current)=>current.length>longest.length?current:longest)).build();if(called){const longestFullName=longestFullNameSelector(state_1.commonState);addon_actions_1.action("longestFullName")(longestFullName)}return{personSelector:personSelector,personsSelector:personsSelector,fullNameSelector:fullNameSelector,longestFullNameSelector:longestFullNameSelector}},[called]);return react_1.default.createElement(ChainSelectorGraph_1.ChainSelectorGraph,{selectors:selectors,onCallButtonClick:()=>setCalled(!0)})}).add("switch dependency example",()=>{const[documentId,setDocumentId]=react_1.useState(),selectors=react_1.useMemo(()=>{const personSelector=(state,props)=>state.persons[props.id],messageSelector=(state,props)=>state.messages[props.id],documentSelector=(state,props)=>state.documents[props.id],personOrMessageByDocumentIdSelector=createChainSelector_1.createChainSelector(documentSelector).chain(document=>100===document.messageId?createBoundSelector_1.createBoundSelector(personSelector,{id:1}):createBoundSelector_1.createBoundSelector(messageSelector,{id:document.messageId})).build();if(void 0!==documentId){const personOrMessageByDocumentId=personOrMessageByDocumentIdSelector(state_1.commonState,{id:documentId});addon_actions_1.action("personOrMessageByDocumentId")(personOrMessageByDocumentId)}return{personSelector:personSelector,messageSelector:messageSelector,documentSelector:documentSelector,personOrMessageByDocumentIdSelector:personOrMessageByDocumentIdSelector}},[documentId]);return react_1.default.createElement(ChainSelectorGraph_1.ChainSelectorGraph,{selectors:selectors,onCallButtonClick:()=>setDocumentId(111===documentId?222:111)})})}).call(this,__webpack_require__(49)(module))},836:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.commonState=void 0,exports.commonState={persons:{1:{id:1,firstName:"Marry",secondName:"Poppins"},2:{id:2,firstName:"Harry",secondName:"Potter"}},messages:{100:{id:100,personId:1,date:new Date("2018-12-29"),text:"Hello"},200:{id:200,personId:2,date:new Date("2018-12-30"),text:"Buy"}},documents:{111:{id:111,messageId:100,data:[1,2,3]},222:{id:222,messageId:200,data:[4,5,6]}}}},837:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSequenceSelector=void 0;const reselect_1=__webpack_require__(87);exports.createSequenceSelector=function createSequenceSelector(selectors,selectorCreator=reselect_1.createSelector){return selectorCreator(selectors,(...results)=>results)}},838:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createChainSelector=exports.SelectorMonad=void 0;const re_reselect_1=__webpack_require__(839),helpers_1=__webpack_require__(111),createKeySelectorCreator_1=__webpack_require__(369),stringComposeKeySelectors_1=__webpack_require__(370),sumString=source=>{const stringSource=String(source);let result=0;for(let i=stringSource.length-1;i>=0;i-=1){result+=stringSource[i].charCodeAt(0)}return result};class SelectorMonad{constructor(selector,options={},prevChain){this.selector=selector,this.options=options,this.prevChain=prevChain}chain(fn,inputOptions){const options=Object.assign(Object.assign({},this.options),inputOptions),keySelector=helpers_1.isCachedSelector(this.selector)?this.selector.keySelector:helpers_1.defaultKeySelector,{cacheObjectCreator:cacheObjectCreator=(()=>{}),keySelectorComposer:keySelectorComposer=stringComposeKeySelectors_1.stringComposeKeySelectors}=options,keySelectorCreator=createKeySelectorCreator_1.createKeySelectorCreator(keySelectorComposer),higherOrderSelector=re_reselect_1.createCachedSelector(this.selector,fn)({keySelector:keySelector,cacheObject:cacheObjectCreator()});helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(higherOrderSelector,()=>`higher order for ${helpers_1.getSelectorName(this.selector)} (${sumString(fn)})`);const combinedSelector=(state,props)=>{const derivedSelector=higherOrderSelector(state,props);if(combinedSelector.dependencies=[higherOrderSelector,derivedSelector],helpers_1.isDebugMode()){helpers_1.getSelectorName(derivedSelector)||helpers_1.defineDynamicSelectorName(derivedSelector,()=>`derived from ${helpers_1.getSelectorName(this.selector)} (${(selector=>{var _a;const dependencies=null!==(_a=selector.dependencies)&&void 0!==_a?_a:[];let result=sumString(selector);for(let i=dependencies.length-1;i>=0;i-=1){const dependency=dependencies[i];result+=sumString(dependency)}return result})(derivedSelector)})`),helpers_1.defineDynamicSelectorName(combinedSelector,()=>`${helpers_1.getSelectorName(this.selector)} (chained by ${helpers_1.getSelectorName(derivedSelector)})`)}return derivedSelector(state,props)};combinedSelector.dependencies=[higherOrderSelector],combinedSelector.cache=higherOrderSelector.cache;const higherOrderKeySelector=re_reselect_1.createCachedSelector(higherOrderSelector,derivedSelector=>keySelectorCreator({inputSelectors:[higherOrderSelector,derivedSelector]}))({keySelector:keySelector,cacheObject:cacheObjectCreator()});combinedSelector.keySelector=(state,props)=>higherOrderKeySelector(state,props)(state,props),helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(combinedSelector,()=>`${helpers_1.getSelectorName(this.selector)} (will be chained ${sumString(fn)})`);const prevChain=Object.assign(fn,{parentChain:this.prevChain});return new SelectorMonad(combinedSelector,options,prevChain)}map(fn,options){return this.chain(result=>{const output=fn(result),selector=()=>output;return helpers_1.isDebugMode()&&helpers_1.defineDynamicSelectorName(selector,()=>`mapped from ${helpers_1.getSelectorName(this.selector)} (${sumString(fn)})`),selector},options)}build(){return Object.assign(this.selector,{chainHierarchy:this.prevChain})}}exports.SelectorMonad=SelectorMonad,exports.createChainSelector=function createChainSelector(selector,options){return new SelectorMonad(selector,options)}},840:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChainSelectorGraph=void 0;const react_1=__importDefault(__webpack_require__(44)),addon_actions_1=__webpack_require__(110),SelectorGraph_1=__webpack_require__(147);exports.ChainSelectorGraph=({selectors:selectors,onCallButtonClick:onCallButtonClick})=>react_1.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},react_1.default.createElement("div",null,react_1.default.createElement("button",{type:"button",onClick:onCallButtonClick},"Call Chain Selector")),react_1.default.createElement(SelectorGraph_1.SelectorGraph,{selectors:selectors,onNodeClick:(name,node)=>addon_actions_1.action(name)(node),style:{height:void 0,flexGrow:1}}))},841:function(module,exports,__webpack_require__){"use strict";(function(module){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(66).withSource,__STORY__=(__webpack_require__(66).addSource,"import React, { useMemo } from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { action } from '@storybook/addon-actions';\nimport { createSelector } from 'reselect';\nimport { SelectorGraph } from './SelectorGraph';\nimport { State } from '../__data__/state';\nimport { createPathSelector } from '../createPathSelector';\n\nstoriesOf('createPathSelector', module).add('example', () => {\n  const selectors = useMemo(() => {\n    /* SELECTORS DEFINITION START */\n    const personSelector = (state: State, props: { personId: number }) =>\n      state.persons[props.personId];\n\n    const personFullNameSelector = createSelector(\n      createPathSelector(personSelector).firstName(''),\n      createPathSelector(personSelector).secondName(''),\n      (firstName, secondName) => `${firstName} ${secondName}`,\n    );\n\n    const personShortNameSelector = createSelector(\n      createPathSelector(personSelector).firstName(''),\n      createPathSelector(personSelector).secondName(''),\n      (firstName, secondName) => {\n        const [firstLetter] = Array.from(secondName);\n        return `${firstName} ${firstLetter}.`;\n      },\n    );\n    /* SELECTORS DEFINITION END */\n\n    return {\n      personSelector,\n      personFullNameSelector,\n      personShortNameSelector,\n    };\n  }, []);\n\n  return (\n    <SelectorGraph\n      selectors={selectors}\n      onNodeClick={(name, node) => action(name)(node)}\n    />\n  );\n});\n"),__ADDS_MAP__={"createpathselector--example":{startLoc:{col:44,line:9},endLoc:{col:1,line:44},startBody:{col:55,line:9},endBody:{col:1,line:44}}};const react_1=__importStar(__webpack_require__(44)),react_2=__webpack_require__(88),addon_actions_1=__webpack_require__(110),reselect_1=__webpack_require__(87),SelectorGraph_1=__webpack_require__(147),createPathSelector_1=__webpack_require__(368);react_2.storiesOf("createPathSelector",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/createPathSelector.story.tsx",[],{},"/home/travis/build/sgrishchenko/reselect-utils/packages/reselect-utils/src/__stories__",{})).add("example",()=>{const selectors=react_1.useMemo(()=>{const personSelector=(state,props)=>state.persons[props.personId];return{personSelector:personSelector,personFullNameSelector:reselect_1.createSelector(createPathSelector_1.createPathSelector(personSelector).firstName(""),createPathSelector_1.createPathSelector(personSelector).secondName(""),(firstName,secondName)=>`${firstName} ${secondName}`),personShortNameSelector:reselect_1.createSelector(createPathSelector_1.createPathSelector(personSelector).firstName(""),createPathSelector_1.createPathSelector(personSelector).secondName(""),(firstName,secondName)=>{const[firstLetter]=Array.from(secondName);return`${firstName} ${firstLetter}.`})}},[]);return react_1.default.createElement(SelectorGraph_1.SelectorGraph,{selectors:selectors,onNodeClick:(name,node)=>addon_actions_1.action(name)(node)})})}).call(this,__webpack_require__(49)(module))}},[[371,1,2]]]);
//# sourceMappingURL=main.d70d1a58f5bf20c8e473.bundle.js.map